<div class="chess-container">
  <!-- Game Controls -->
  <div class="controls-panel controls-area">
    <h2 class="text-2xl font-bold mb-4 text-white">Chess Teacher</h2>

    <!-- Game Status -->
    <div class="status-card">
      <h3 class="text-lg font-semibold mb-2">Game Status</h3>
      <div class="status-info">
        <p>
          <span class="label">Turn:</span> <span class="value capitalize">{{ turn() }}</span>
        </p>
        @if (isCheck()) {
        <p class="check-warning">âš ï¸ Check!</p>
        } @if (isCheckmate()) {
        <p class="checkmate-warning">ğŸ Checkmate!</p>
        } @if (isStalemate()) {
        <p class="stalemate-warning">ğŸ¤ Stalemate!</p>
        }
      </div>
    </div>

    <!-- Move History -->
    <div class="move-history">
      <h3 class="text-lg font-semibold mb-2">Move History</h3>
      <div class="moves-list">
        @for (pair of movePairs(); track $index) {
        <div class="move-pair">
          <span class="move-number">{{ $index + 1 }}.</span>
          <span class="move-white">{{ pair.white }}</span>
          @if (pair.black) {
          <span class="move-black">{{ pair.black }}</span>
          }
        </div>
        } @empty {
        <p class="text-gray-400 text-sm">No moves yet</p>
        }
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button (click)="resetGame()" class="btn btn-primary">ğŸ”„ New Game</button>
      <button (click)="undoMove()" class="btn btn-secondary">â†¶ Undo</button>
      <button (click)="flipBoard()" class="btn btn-secondary">ğŸ”ƒ Flip Board</button>
      <button (click)="toggleOptions()" class="btn btn-secondary">âš™ï¸ Settings</button>
    </div>
  </div>

  <!-- Analysis Panel -->
  <div class="side-panel">
    <app-analysis-panel [fen]="fen()"></app-analysis-panel>
    <app-opening-explorer
      [fen]="fen()"
      (moveSelected)="onOpeningMove($event)"
      (openingName)="onOpeningNameChange($event)"
    >
    </app-opening-explorer>
  </div>

  <!-- Chess Board -->
  <div class="board-wrapper board-area">
    <div class="board-header">
      @if(openingName()) {
      <span class="opening-label">{{ openingName() }}</span>
      }
    </div>
    <div
      #board
      class="chessboard"
      [ngClass]="['theme-' + currentBoardTheme(), 'pieces-' + currentPieceTheme()]"
    ></div>
  </div>

  <app-options-dialog
    [visible]="showOptions()"
    [currentBoardTheme]="currentBoardTheme()"
    [currentPieceTheme]="currentPieceTheme()"
    [whitePlayerType]="whitePlayerType()"
    [blackPlayerType]="blackPlayerType()"
    [whiteComputerElo]="whiteComputerElo()"
    [blackComputerElo]="blackComputerElo()"
    (close)="showOptions.set(false)"
    (settingsChange)="updateSettings($event)"
  >
  </app-options-dialog>
</div>
